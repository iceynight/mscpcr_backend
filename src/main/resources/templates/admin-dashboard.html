<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>MSCPCR Dashboard</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no'
        name='viewport' />
    <link rel="stylesheet" th:href="@{/css/demo.css}">
    <link rel="stylesheet" th:href="@{/css/ready.css}">
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <style>
        .stat-card {
            color: #fff;
            border-radius: 12px;
            padding: 32px 24px;
            margin-bottom: 24px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.07);
            transition: transform 0.2s, box-shadow 0.2s;
            text-align: center;
        }
        .stat-card:hover {
            transform: translateY(-4px) scale(1.03);
            box-shadow: 0 6px 24px rgba(0,0,0,0.13);
        }
        .stat-card i {
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: block;
        }
        .stat-value {
            font-size: 2.2rem;
            font-weight: bold;
        }
        .stat-title {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        @media (max-width: 767px) {
            .stat-card { padding: 20px 10px; }
            .stat-value { font-size: 1.5rem; }
        }
    </style>
</head>
<body>
    <div class="wrapper">
        <div class="main-header">
            <div class="logo-header">
                <a href="index.html" class="logo">
                    MSCPCR Dashboard
                </a>
                <button class="navbar-toggler sidenav-toggler ml-auto" type="button" data-toggle="collapse" data-target="collapse" aria-controls="sidebar" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <button class="topbar-toggler more"><i class="la la-ellipsis-v"></i></button>
            </div>
            <nav class="navbar navbar-header navbar-expand-lg">
                <div class="container-fluid">
                    
                    <form class="navbar-left navbar-form nav-search mr-md-3" action="">
                        <div class="input-group">
                            <input type="text" placeholder="Search ..." class="form-control">
                            <div class="input-group-append">
                                <span class="input-group-text">
                                    <i class="la la-search search-icon"></i>
                                </span>
                            </div>
                        </div>
                    </form>
                    <!-- Add New User Button -->
                    <button class="btn btn-primary" th:onclick="'window.location.href=\'' + @{/admin/create-user} + '\''">
                        Add New User
                    </button>
                    
                </div>
            </nav>
        </div>
        <div class="sidebar">
            <div class="scrollbar-inner sidebar-wrapper">
                <div class="user">
                    <div class="photo">
                        <img src="assets/img/profile.jpg">
                    </div>
                    <div class="info">
                        <a class="" data-toggle="collapse" href="#collapseExample" aria-expanded="true">
                            <span>
                                Hizrian
                                <span class="user-level">Administrator</span>
                                <span class="caret"></span>
                            </span>
                        </a>
                        <div class="clearfix"></div>

                        <div class="collapse in" id="collapseExample" aria-expanded="true" style="">
                            <ul class="nav">
                                <li>
                                    <a href="#profile">
                                        <span class="link-collapse">My Profile</span>
                                    </a>
                                </li>
                                <li>
                                    <a href="#edit">
                                        <span class="link-collapse">Edit Profile</span>
                                    </a>
                                </li>
                                <li>
                                    <a href="#settings">
                                        <span class="link-collapse">Settings</span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <ul class="nav">
                    <li class="nav-item active">
                        <a href="index.html">
                            <i class="la la-dashboard"></i>
                            <p>Dashboard</p>
                            <span class="badge badge-count">5</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="components.html">
                            <i class="la la-table"></i>
                            <p>Components</p>
                            <span class="badge badge-count">14</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="forms.html">
                            <i class="la la-keyboard-o"></i>
                            <p>Forms</p>
                            <span class="badge badge-count">50</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="tables.html">
                            <i class="la la-th"></i>
                            <p>Tables</p>
                            <span class="badge badge-count">6</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="notifications.html">
                            <i class="la la-bell"></i>
                            <p>Notifications</p>
                            <span class="badge badge-success">3</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="typography.html">
                            <i class="la la-font"></i>
                            <p>Typography</p>
                            <span class="badge badge-danger">25</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="icons.html">
                            <i class="la la-fonticons"></i>
                            <p>Icons</p>
                        </a>
                    </li>
                    <li class="nav-item update-pro">
                        <button  data-toggle="modal" data-target="#modalUpdate">
                            <i class="la la-hand-pointer-o"></i>
                            <p>Update To Pro</p>
                        </button>
                    </li>
                </ul>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="main-panel">
            <div class="content">
                <div class="container-fluid">
                    <!-- Notification Area -->
                    <div th:if="${notification}" class="alert alert-success alert-dismissible fade show" role="alert" id="caseNotification">
                        <i class="la la-bell"></i>
                        <span th:text="${notification}">Notification message</span>
                        <button type="button" class="close" data-dismiss="alert">&times;</button>
                    </div>

                    <div class="row">
                        <!-- First Row of Cards -->
                        <div class="col-md-4">
                            <div class="stat-card" style="background: linear-gradient(135deg, #2ecc71, #27ae60);">
                                <div class="d-flex justify-content-center align-items-center">
                                    <div>
                                        
                                        <div class="stat-value" id="casesSolved">0</div>
                                        <div class="stat-title">Cases Solved</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="stat-card" style="background: linear-gradient(135deg, #3498db, #2980b9);">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                       
                                        <div class="stat-value" id="casesProcessing">0</div>
                                        <div class="stat-title">Cases in Processing</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="stat-card" style="background: linear-gradient(135deg, #e74c3c, #c0392b);">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                       
                                        <div class="stat-value" id="totalCases">0</div>
                                        <div class="stat-title">Total Cases</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <!-- Second Row of Cards -->
                        <div class="col-md-4">
                            <div class="stat-card" style="background: linear-gradient(135deg, #f39c12, #d35400);">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        
<div class="stat-value" id="casesProcessingDCPU">0</div>
                                        <div class="stat-title">Cases in DCPU</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="stat-card" style="background: linear-gradient(135deg, #9b59b6, #8e44ad);">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                       
<div class="stat-value" id="casesProcessingPolice">0</div>
                                        <div class="stat-title">Processing in Police</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="stat-card" style="background: linear-gradient(135deg, #1abc9c, #16a085);">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        
<div class="stat-value" id="casesProcessingCourt">0</div>
                                        <div class="stat-title">Processing in Court</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal -->
    <div class="modal fade" id="modalUpdate" tabindex="-1" role="dialog" aria-labelledby="modalUpdatePro" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header bg-primary">
                    <h6 class="modal-title"><i class="la la-frown-o"></i> Under Development</h6>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body text-center">									
                    <p>Currently the pro version of the <b>Ready Dashboard</b> Bootstrap is in progress development</p>
                    <p>
                        <b>We'll let you know when it's done</b></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</body>
<script th:src="@{/js/core/jquery.3.2.1.min.js}"></script>
<script th:src="@{/js/plugin/jquery-ui-1.12.1.custom/jquery-ui.min.js}"></script>
<script th:src="@{/js/core/popper.min.js}"></script>
<script th:src="@{/js/core/bootstrap.min.js}"></script>
<script th:src="@{/js/plugin/chartist/chartist.min.js}"></script>
<script th:src="@{/js/plugin/chartist/plugin/chartist-plugin-tooltip.min.js}"></script>
<script th:src="@{/js/plugin/bootstrap-notify/bootstrap-notify.min.js}"></script>
<script th:src="@{/js/plugin/bootstrap-toggle/bootstrap-toggle.min.js}"></script>
<script th:src="@{/js/plugin/jquery-mapael/jquery.mapael.min.js}"></script>
<script th:src="@{/js/plugin/jquery-mapael/maps/world_countries.min.js}"></script>
<script th:src="@{/js/plugin/chart-circle/circles.min.js}"></script>
<script th:src="@{/js/plugin/jquery-scrollbar/jquery.scrollbar.min.js}"></script>
<script th:src="@{/js/ready.min.js}"></script>
<script th:src="@{/js/demo.js}"></script>
<script>
document.addEventListener("DOMContentLoaded", function() {
    var notif = document.getElementById("caseNotification");
    if (notif) {
        setTimeout(function() {
            $(notif).alert('close');
        }, 5000);
    }
});

$(document).ready(function () {
    $.ajax({
        url: 'http://localhost:8083/api/legalcase/currentstatuses', 
        method: 'GET',
        success: function (response) {
            let solvedCount = 0;
            let casesInDCPU = 0;
            let processingInPolice = 0;
            let processingInCourt = 0;
            response.forEach(status => {
                if (status === 'solved') {
                    solvedCount++;
                } else if (status === 'dcpuprocessing') {
                    casesInDCPU++;
                } else if (status === 'policeprocessing') {
                    processingInPolice++;
                } else if (status === 'courtprocessing') {
                    processingInCourt++;
                } 
            });

            let processingCount = casesInDCPU + processingInPolice + processingInCourt;
            let totalCount = solvedCount + processingCount;

            // Update HTML
            $('#casesSolved').text(solvedCount);
            $('#casesProcessing').text(processingCount);
            $('#totalCases').text(totalCount);  
            $('#casesProcessingDCPU').text(casesInDCPU);
            $('#casesProcessingPolice').text(processingInPolice);   
            $('#casesProcessingCourt').text(processingInCourt);
        },
        error: function (xhr, status, error) {
            console.error("Failed to fetch case data:", error);
        }
    });
});
</script>
</html>